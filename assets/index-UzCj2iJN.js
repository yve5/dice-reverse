(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function l(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=l(o);fetch(o.href,r)}})();const Bt=function(){this.from=0,this.to=0,this.res=0},$t=function(){this.area_c=0,this.area_tc=0,this.dice_c=0,this.dice_jun=0,this.stock=0},At=function(){this.size=0,this.cpos=0,this.arm=0,this.dice=0,this.left=0,this.right=0,this.top=0,this.bottom=0,this.cx=0,this.cy=0,this.len_min=0,this.line_cel=new Array(100),this.line_dir=new Array(100),this.join=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},Et=function(){this.dir=[0,0,0,0,0,0]},Nt=function(){this.dn=0,this.arm=0,this.dmax=0,this.deme=[0,0,0,0,0,0,0,0],this.sum=0,this.fin=[0,0,0,0,0,0,0,0],this.usedice=[0,1,2,3,4,5,6,7]},I=28,it=32,v=32,zt=function(e,i,l,a){const o=e%l,r=Math.floor(e/l),m=r%2;let f=0,u=0;switch(i){case 0:f=m,u=-1;break;case 1:f=1;break;case 2:f=m,u=1;break;case 3:f=m-1,u=1;break;case 4:f=-1;break;case 5:f=m-1,u=-1;break}const n=o+f,p=r+u;return n<0||p<0||n>=l||p>=a?-1:p*l+n},Rt=function(){this.cel_max=I*it,this.cel=new Array(this.cel_max),this.join=new Array(this.cel_max);for(let e=0;e<this.cel_max;e+=1){this.join[e]=new Et;for(let i=0;i<6;i+=1)this.join[e].dir[i]=zt(e,i,I,it)}this.AREA_MAX=v,this.adat=[];for(let e=0;e<32;e+=1)this.adat[e]=new At;this.num=new Array(this.cel_max);for(let e=0;e<this.cel_max;e+=1)this.num[e]=e;this.rcel=new Array(this.cel_max),this.next_f=new Array(this.cel_max),this.alist=new Array(v),this.chk=new Array(v),this.tc=new Array(v),this.pmax=7,this.user=0,this.put_dice=3,this.jun=[0,1,2,3,4,5,6,7],this.ban=0,this.area_from=0,this.area_to=0,this.defeat=0,this.player=new Array(8),this.STOCK_MAX=64,this.listFrom=new Array(v*v),this.listTo=new Array(v*v),this.his=[],this.his_c=0,this.his_arm=new Array(v),this.his_dice=new Array(v),this.start_game=function(){for(let e=0;e<8;e+=1)this.jun[e]=e;for(let e=0;e<this.pmax;e+=1){const i=Math.floor(Math.random()*this.pmax),l=this.jun[e];this.jun[e]=this.jun[i],this.jun[i]=l}this.ban=0;for(let e=0;e<8;e+=1)this.player[e]=new $t;for(let e=0;e<8;e+=1)this.set_area_tc(e);this.his_c=0;for(let e=0;e<v;e+=1)this.his_arm[e]=this.adat[e].arm,this.his_dice[e]=this.adat[e].dice},this.set_area_tc=function(e){this.player[e].area_tc=0;for(let l=0;l<v;l+=1)this.chk[l]=l;for(;;){let l=0;for(let a=1;a<v;a+=1)if(this.adat[a].size!==0&&this.adat[a].arm===e){for(let o=1;o<v;o+=1)if(this.adat[o].size!==0&&this.adat[o].arm===e&&this.adat[a].join[o]!==0&&this.chk[o]!==this.chk[a]){this.chk[a]>this.chk[o]?this.chk[a]=this.chk[o]:this.chk[o]=this.chk[a],l=1;break}if(l)break}if(l===0)break}for(let l=0;l<v;l+=1)this.tc[l]=0;for(let l=1;l<v;l+=1)this.adat[l].size!==0&&this.adat[l].arm===e&&(this.tc[this.chk[l]]+=1);let i=0;for(let l=0;l<v;l+=1)this.tc[l]>i&&(i=this.tc[l]);this.player[e].area_tc=i},this.get_pn=function(){return this.jun[this.ban]},this.make_map=function(){let e;for(let n=0;n<this.cel_max;n+=1){const p=Math.floor(Math.random()*this.cel_max),c=this.num[n];this.num[n]=this.num[p],this.num[p]=c}for(let n=0;n<this.cel_max;n+=1)this.cel[n]=0,this.rcel[n]=0;let i=1;for(this.rcel[Math.floor(Math.random()*this.cel_max)]=1;;){let n,p=9999;for(let h=0;h<this.cel_max;h+=1)this.cel[h]>0||this.num[h]>p||this.rcel[h]!==0&&(p=this.num[h],n=h);if(p===9999||this.percolate(n,8,i)===0||(i+=1,i>=v))break}for(let n=0;n<this.cel_max;n+=1){if(this.cel[n]>0)continue;let p=0,c=0;for(let h=0;h<6;h+=1){const _=this.join[n].dir[h];_<0||(this.cel[_]===0?p=1:c=this.cel[_])}p===0&&(this.cel[n]=c)}for(let n=0;n<v;n+=1)this.adat[n]=new At;for(let n=0;n<this.cel_max;n+=1)i=this.cel[n],i>0&&(this.adat[i].size+=1);for(let n=1;n<v;n+=1)this.adat[n].size<=5&&(this.adat[n].size=0);for(let n=0;n<this.cel_max;n+=1)i=this.cel[n],this.adat[i].size===0&&(this.cel[n]=0);for(let n=1;n<v;n+=1)this.adat[n].left=I,this.adat[n].right=-1,this.adat[n].top=it,this.adat[n].bottom=-1,this.adat[n].len_min=9999;e=0;for(let n=0;n<it;n+=1)for(let p=0;p<I;p+=1)i=this.cel[e],i>0&&(p<this.adat[i].left&&(this.adat[i].left=p),p>this.adat[i].right&&(this.adat[i].right=p),n<this.adat[i].top&&(this.adat[i].top=n),n>this.adat[i].bottom&&(this.adat[i].bottom=n)),e+=1;for(let n=1;n<v;n+=1)this.adat[n].cx=Math.floor((this.adat[n].left+this.adat[n].right)/2),this.adat[n].cy=Math.floor((this.adat[n].top+this.adat[n].bottom)/2);e=0;let l,a,o;for(let n=0;n<it;n+=1)for(let p=0;p<I;p+=1){if(i=this.cel[e],i>0){a=this.adat[i].cx-p,a<0&&(a=-a),o=this.adat[i].cy-n,o<0&&(o=-o),l=a+o;let c=0;for(let h=0;h<6;h+=1){const _=this.join[e].dir[h];if(_>0){const C=this.cel[_];C!==i&&(c=1,this.adat[i].join[C]=1)}}c&&(l+=4),l<this.adat[i].len_min&&(this.adat[i].len_min=l,this.adat[i].cpos=n*I+p)}e+=1}for(let n=0;n<v;n+=1)this.adat[n].arm=-1;let r=0;const m=new Array(v);for(;;){let n=0;for(let c=1;c<v;c+=1)this.adat[c].size!==0&&(this.adat[c].arm>=0||(m[n]=c,n+=1));if(n===0)break;const p=m[Math.floor(Math.random()%n)];this.adat[p].arm=r,r+=1,r>=this.pmax&&(r=0)}for(let n=0;n<v;n+=1)this.chk[n]=0;for(let n=0;n<this.cel_max;n+=1){const p=this.cel[n];if(p!==0&&!(this.chk[p]>0))for(let c=0;c<6&&!(this.chk[p]>0);c+=1){const h=this.join[n].dir[c];h>=0&&this.cel[h]!==p&&(this.set_area_line(n,c),this.chk[p]=1)}}let f=0;for(let n=1;n<v;n+=1)this.adat[n].size>0&&(f+=1,this.adat[n].dice=1);f*=this.put_dice-1;let u=0;for(let n=0;n<f;n+=1){const p=new Array(v);let c=0;for(let _=1;_<v;_+=1)this.adat[_].size!==0&&this.adat[_].arm===u&&(this.adat[_].dice>=8||(p[c]=_,c+=1));if(c===0)break;const h=p[Math.floor(Math.random()*c)];this.adat[h].dice+=1,u+=1,u>=this.pmax&&(u=0)}},this.percolate=function(e,i,l){i<3&&(i=3);let a=e;for(let r=0;r<this.cel_max;r+=1)this.next_f[r]=0;let o=0;for(;;){this.cel[a]=l,o+=1;for(let m=0;m<6;m+=1){const f=this.join[a].dir[m];f<0||(this.next_f[f]=1)}let r=9999;for(let m=0;m<this.cel_max;m+=1)this.next_f[m]!==0&&(this.cel[m]>0||this.num[m]>r||(r=this.num[m],a=m));if(r===9999||o>=i)break}for(let r=0;r<this.cel_max;r+=1)if(this.next_f[r]!==0&&!(this.cel[r]>0)){this.cel[r]=l,o+=1;for(let m=0;m<6;m+=1){const f=this.join[r].dir[m];f<0||(this.rcel[f]=1)}}return o},this.set_area_line=function(e,i){let l=e,a=i;const o=this.cel[l];let r=0;this.adat[o].line_cel[r]=l,this.adat[o].line_dir[r]=a,r+=1;for(let m=0;m<100;m+=1){a+=1,a>=6&&(a=0);const f=this.join[l].dir[a];if(f>=0&&this.cel[f]===o&&(l=f,a-=2,a<0&&(a+=6)),this.adat[o].line_cel[r]=l,this.adat[o].line_dir[r]=a,r+=1,l===e&&a===i)break}},this.com_thinking=function(){for(let f=0;f<8;f+=1)this.player[f].area_c=0,this.player[f].dice_c=0;let e=0;for(let f=1;f<v;f+=1){if(this.adat[f].size===0)continue;const u=this.adat[f].arm;this.player[u].area_c+=1,this.player[u].dice_c+=this.adat[f].dice,e+=this.adat[f].dice}for(let f=0;f<8;f+=1)this.player[f].dice_jun=f;for(let f=0;f<7;f+=1)for(let u=f+1;u<8;u+=1)if(this.player[f].dice_c<this.player[u].dice_c){const n=this.player[f].dice_jun;this.player[f].dice_jun=this.player[u].dice_jun,this.player[u].dice_jun=n}let i=-1;for(let f=0;f<8;f+=1)this.player[f].dice_c>e*2/5&&(i=f);const l=new Array(v*v),a=new Array(v*v),o=this.jun[this.ban];let r=0;for(let f=1;f<v;f+=1)if(this.adat[f].size!==0&&this.adat[f].arm===o&&!(this.adat[f].dice<=1)){for(let u=1;u<v;u+=1)if(this.adat[u].size!==0&&this.adat[u].arm!==o&&this.adat[f].join[u]!==0&&!(i>=0&&this.adat[f].arm!==i&&this.adat[u].arm!==i)&&!(this.adat[u].dice>this.adat[f].dice)){if(this.adat[u].dice===this.adat[f].dice){const n=this.adat[u].arm;let p=0;if(this.player[o].dice_jun===0&&(p=1),this.player[n].dice_jun===0&&(p=1),Math.random()*10>1&&(p=1),p===0)continue}l[r]=f,a[r]=u,r+=1}}if(r===0)return 0;const m=Math.floor(Math.random()*r);this.area_from=l[m],this.area_to=a[m]},this.set_his=function(e,i,l){this.his[this.his_c]=new Bt,this.his[this.his_c].from=e,this.his[this.his_c].to=i,this.his[this.his_c].res=l,this.his_c+=1}},G="/dice-reverse/sound/",Lt=[{src:`${G}button.wav`,id:"button"},{src:`${G}clear.wav`,id:"clear"},{src:`${G}click.wav`,id:"click"},{src:`${G}dice.wav`,id:"dice"},{src:`${G}fail.wav`,id:"fail"},{src:`${G}myturn.wav`,id:"myturn"},{src:`${G}over.wav`,id:"over"},{src:`${G}success.wav`,id:"success"}];let lt,d,dt,vt=!1,j,z,R,L,g=0,T=0;const s=new Rt,ut=[],B={viewW:840,viewH:840,celW:27,celH:18,yposMes:688,yposArm:770};let y=1,b=1,k,N,W,st,q,mt;const nt=[],ht=[],t=[];let Q=0,H=0,D=0,ot=0,gt=0,K=0,Z=0,X=0,J=0,O=0,U=0,at=0,rt=0,pt=0,M=0,x=0,ct=0;const S=[],tt=[];let ft=0,et=-1;const Y=[],A=[];let w=0,E=0,yt=!0;const wt=()=>{location.href="https://www.gamedesign.jp/"},$=e=>e*y/b,P=e=>{yt&&(ut[e].setVolume(.5),ut[e].play())},Yt=e=>{z!=null&&z(e),lt.style.cursor="default"},Ot=e=>{R!=null&&R(e),lt.style.cursor="default"},Pt=e=>{L!=null&&L(e),lt.style.cursor="default",et>=0&&Y[et]!=null&&(P("button"),Y[et]())},Wt=()=>{let e,i=-1;for(let l=0;l<ft;l+=1)if(e=x+l,t[e].visible){const a=t[e].globalToLocal(d.mouseX,d.mouseY);t[e].hitTest(a.x,a.y)&&(i=l)}if(et!==i){et=i;for(let l=0;l<ft;l+=1)l===et?t[x+l].getChildAt(0).gotoAndStop("press"):t[x+l].getChildAt(0).gotoAndStop("btn");d.update()}},Ft=()=>{j!=null&&j(),Wt()},Ht=e=>{ut[e]=createjs.Sound.createInstance(e)},Dt=e=>{const i={...e.item};i.type===createjs.LoadQueue.SOUND&&Ht(i.id)},F=(e,i,l)=>{if(s.adat[i].size===0){t[e].visible=!1;return}t[e].visible=!0,t[e].graphics.clear();let a=0,o=s.adat[i].line_cel[a],r=s.adat[i].line_dir[a];const m=[W/2,W,W,W/2,0,0,W/2],f=3*y/b,u=[-f,f,st-f,st+f,st-f,f,-f];let n="#222244";l&&(n="#ff0000"),t[e].graphics.beginStroke(n);let c=["#b37ffe","#b3ff01","#009302","#ff7ffe","#ff7f01","#b3fffe","#ffff01","#ff5858"][s.adat[i].arm];l&&(c="#000000"),t[e].graphics.setStrokeStyle(4*y/b,"round","round").beginFill(c);let h=m[r],_=u[r];t[e].graphics.moveTo(nt[o]+h,ht[o]+_);for(let C=0;C<100&&(h=m[r+1],_=u[r+1],t[e].graphics.lineTo(nt[o]+h,ht[o]+_),a+=1,o=s.adat[i].line_cel[a],r=s.adat[i].line_dir[a],!(o===s.adat[i].line_cel[0]&&r===s.adat[i].line_dir[0]));C+=1);},V=(e,i)=>{if(s.adat[i].size===0){t[e].visible=!1;return}t[e].visible=!0;const l=s.adat[i].cpos;t[e].x=Math.floor(nt[l]+6*y/b),t[e].y=Math.floor(ht[l]-10*y/b),t[e].gotoAndStop(s.adat[i].arm*10+s.adat[i].dice-1)},bt=()=>{let e=0;for(let l=0;l<8;l+=1){t[Z+l].visible=!1;const a=s.jun[l];s.player[a].area_tc>0&&(t[Z+l].visible=!0,e+=1)}let i=0;for(let l=0;l<8;l+=1){const a=s.jun[l];if(s.player[a].area_tc!==0){const o=Z+l,r=100*y/b,m=k/2-(e-1)*r/2+i*r;t[o].x=m,t[o].y=mt,t[o].getChildAt(0).gotoAndStop(`d${a}0`),t[o].getChildAt(1).text=`${s.player[a].area_tc}`,t[o].getChildAt(2).text="",s.player[a].stock>0&&(t[o].getChildAt(2).text=`${s.player[a].stock}`),l===s.ban&&(t[K].x=m,t[K].y=mt,t[K].gotoAndStop("ban"),t[K].visible=!0),i+=1}}},Gt=()=>{for(let e=0;e<s.pmax;e+=1){s.ban+=1,s.ban>=s.pmax&&(s.ban=0);const i=s.jun[s.ban];if(s.player[i].area_tc)break}s.jun[s.ban]===s.user&&P("myturn"),_t()},It=()=>{const e=s.jun[s.ban],i=[];let l=0;for(let o=0;o<s.AREA_MAX;o+=1)s.adat[o].size!==0&&s.adat[o].arm===e&&(s.adat[o].dice>=8||(i[l]=o,l+=1));if(l===0||s.player[e].stock<=0){Gt();return}s.player[e].stock-=1;const a=i[Math.floor(Math.random()*l)];s.adat[a].dice+=1,V(tt[a],a);for(let o=0;o<s.STOCK_MAX;o+=1)o<s.player[e].stock?t[J].getChildAt(o).visible=!0:t[J].getChildAt(o).visible=!1;s.set_his(a,0,0),d.update()},Kt=()=>{g-=1,!(g>0)&&(j=It)},Mt=()=>{t[H].visible=!1,t[D].visible=!1,t[x+4].visible=!1;const e=s.jun[s.ban];s.set_area_tc(e),s.player[e].stock+=s.player[e].area_tc,s.player[e].stock>s.STOCK_MAX&&(s.player[e].stock=s.STOCK_MAX),t[J].visible=!0;for(let i=0;i<s.STOCK_MAX;i+=1)i<s.player[e].stock?(t[J].getChildAt(i).visible=!0,t[J].getChildAt(i).gotoAndStop(`d${e}3`)):t[J].getChildAt(i).visible=!1;d.update(),g=10,j=Kt,z=null,R=null,L=null},Ut=()=>{t[x+4].visible=!1,t[H].visible=!1,t[D].visible=!1,t[M].visible=!1,j=null,z=null,R=null,L=null,Mt()},jt=()=>{let e=-1,i;for(let l=0;l<s.AREA_MAX;l+=1)if(s.adat[l].size!==0){i=Q+l;const a=t[i].globalToLocal(d.mouseX,d.mouseY);t[i].hitTest(a.x,a.y)&&(e=l)}for(let l=0;l<s.AREA_MAX;l+=1){const a=S[l].an;if(s.adat[a].size!==0){i=ot+l;const o=t[i].globalToLocal(d.mouseX,d.mouseY);t[i].hitTest(o.x,o.y)&&(e=a)}}return e},qt=()=>{const e=s.jun[s.ban],i=jt();if(!(i<0)){if(i===s.area_from){Ct();return}s.adat[i].arm!==e&&s.adat[i].join[s.area_from]!==0&&(s.area_to=i,F(D,i,1),d.update(),P("click"),Tt())}},Qt=()=>{const e=s.jun[s.ban],i=jt();i<0||s.adat[i].arm===e&&(s.adat[i].dice<=1||(t[M].visible=!1,s.area_from=i,F(H,i,1),P("click"),d.update(),z=qt))},Ct=()=>{t[M].visible=!0,t[M].text="1. Click your area. 2. Click neighbor to attack.",t[M].color="#000000",t[M].textAlign="left",t[M].x=k*.05,t[M].y=q,et=-1,t[x+4].x=k-100*y/b,t[x+4].y=q,t[x+4].visible=!0,Y[4]=Ut,t[H].visible=!1,t[D].visible=!1,d.update(),j=null,z=Qt,R=null,L=null},_t=()=>{for(let e=gt;e<ct;e+=1)t[e].visible=!1;bt(),s.jun[s.ban]===s.user?Ct():ee()},Vt=()=>{s.start_game(),_t()},kt=()=>{let e;for(let i=0;i<ct;i+=1)t[i].visible=!1;s.make_map();for(let i=0;i<s.AREA_MAX;i+=1)e=S[i].an,S[i].cpos=s.adat[e].cpos;for(let i=0;i<s.AREA_MAX-1;i+=1)for(let l=i;l<s.AREA_MAX;l+=1)if(S[i].cpos>S[l].cpos){let a=S[i].an;S[i].an=S[l].an,S[l].an=a,a=S[i].cpos,S[i].cpos=S[l].cpos,S[l].cpos=a}for(let i=0;i<s.AREA_MAX;i+=1)e=S[i].an,tt[e]=ot+i;for(let i=0;i<s.AREA_MAX;i+=1)F(Q+i,i,0);for(let i=0;i<s.AREA_MAX;i+=1)V(ot+i,S[i].an);t[M].visible=!0,t[M].text="Play this board?",t[M].color="#000000",t[M].textAlign="left",t[M].x=k*.1,t[M].y=q,t[x+2].x=$(500),t[x+2].y=q,t[x+2].visible=!0,Y[2]=Vt,t[x+3].x=$(650),t[x+3].y=q,t[x+3].visible=!0,Y[3]=kt,d.update(),j=null,z=null,R=null,L=null},xt=()=>{for(let e=0;e<ct;e+=1)t[e].visible=!1;t[at].visible=!0,t[at].x=0,t[at].y=0,t[at].gotoAndStop("title"),t[M].visible=!0,t[M].text="Copyright (C) 2001 GAMEDESIGN",t[M].color="#aaaaaa",t[M].textAlign="right",t[M].x=k*.9,t[M].y=N*.24,t[rt].visible=!0;for(let e=0;e<7;e+=1)t[rt].getChildByName(`p${e}`).color=e===s.pmax-2?"#aa0000":"#cccccc";t[x+0].x=$(640),t[x+0].y=$(390),t[x+0].visible=!0,Y[0]=kt,t[x+1].x=$(640),t[x+1].y=$(490),t[x+1].visible=!0,Y[1]=wt,d.update(),j=null,z=te,R=null,L=null},St=()=>{t[pt].visible=!0,t[pt].text=" ",t[M].visible=!0,t[M].text="Now loading... ",t[M].x=k/2,t[M].y=N/2,d.update(),g-=1,g<=0&&(j=null,xt())},Jt=()=>{g=30,j=St},Zt=()=>{let e;lt=document.getElementById("myCanvas"),d=new createjs.Stage(lt),createjs.Touch.isSupported()===!0&&(createjs.Touch.enable(d),vt=!0),vt&&(yt=!1);const i=window.innerWidth,l=window.innerHeight;i/B.viewW<l/B.viewH?(y=i,b=B.viewW):(y=l,b=B.viewH),k=Math.floor(B.viewW*y/b),N=Math.floor(B.viewH*y/b),d.canvas.width=k,d.canvas.height=N,W=B.celW*y/b,st=B.celH*y/b,q=B.yposMes*y/b,mt=B.yposArm*y/b;for(let c=0;c<2;c+=1)A[c]=new Nt;let a=0;e=0;for(let c=0;c<it;c+=1)for(let h=0;h<I;h+=1)nt[e]=h*W,c%2&&(nt[e]+=W/2),ht[e]=c*st,e+=1;Q=a;for(let c=0;c<s.AREA_MAX+2;c+=1)t[a]=new createjs.Shape,t[a].x=k/2-I*W/2-W/4,t[a].y=50*y/b,d.addChild(t[a]),a+=1;H=Q+s.AREA_MAX,D=Q+s.AREA_MAX+1,ot=a,dt=new createjs.SpriteSheetBuilder;const o=new lib.areadice,r=new createjs.Rectangle(0,0,80,100);dt.addMovieClip(o,r,y/b);const m=dt.build();for(let c=0;c<s.AREA_MAX;c+=1)t[a]=new createjs.Sprite(m),d.addChild(t[a]),a+=1;for(let c=0;c<s.AREA_MAX;c+=1)S[c]={},S[c].an=c,S[c].cpos=0;gt=a,K=a,t[a]=new lib.mc,d.addChild(t[a]),t[a].scaleX=y/b,t[a].scaleY=y/b,a+=1,Z=a;for(let c=0;c<8;c+=1){const h=new lib.mc;h.scaleX=.12,h.scaleY=.12,h.x=-22,h.y=0,t[a]=new createjs.Container,t[a].addChildAt(h,0);const _=new createjs.Text("","32px Anton","Black");_.textBaseline="middle",_.x=5,t[a].addChildAt(_,1);const C=new createjs.Text("","16px Anton","Black");C.textBaseline="middle",C.x=5,C.y=28,t[a].addChildAt(C,2),d.addChild(t[a]),t[a].scaleX=y/b,t[a].scaleY=y/b,a+=1}X=a,t[a]=new createjs.Container,t[a].y=q,t[a].x=k/2,t[a].scaleX=y/b,t[a].scaleY=y/b;const f=new createjs.Shape;f.graphics.beginFill("rgba(255,255,255,0.8)").drawRect(-B.viewW/2,-50,B.viewW,360),t[a].addChild(f);for(let c=0;c<2;c+=1){for(let _=0;_<8;_+=1){const C=new lib.mc;C.scaleX=.15,C.scaleY=.15,C.name=`s${c}${_}`,t[a].addChild(C)}for(let _=0;_<8;_+=1){const C=new lib.mc;C.scaleX=.15,C.scaleY=.15,C.name=`d${c}${_}`,t[a].addChild(C)}const h=new createjs.Text("37","80px Anton","Black");h.textBaseline="middle",h.textAlign="center",h.name=`n${c}`,t[a].addChild(h)}d.addChild(t[a]),a+=1,J=a,t[a]=new createjs.Container,t[a].y=q,t[a].x=k/2,t[a].scaleX=y/b,t[a].scaleY=y/b;for(let c=0;c<s.STOCK_MAX;c+=1){const h=new lib.mc,_=40;h.x=-(6.5*_)+Math.floor(c/4)*_-c%4*_*.5,h.y=-_*.7+Math.floor(c%4)*_/2,h.gotoAndStop("d00"),h.scaleX=.1,h.scaleY=.1,t[a].addChildAt(h,c)}d.addChild(t[a]),a+=1,O=a,t[a]=new createjs.Container,t[a].x=k/2,t[a].y=N/2,t[a].scaleX=y/b,t[a].scaleY=y/b;const u=new createjs.Shape;u.graphics.beginFill("#000000").drawRect(-B.viewW/2+10,-180,B.viewW-20,360),u.name="bg",t[a].addChild(u);const n=new createjs.Text("G A M E O V E R","80px Anton","White");n.textBaseline="middle",n.textAlign="center",n.name="mes",t[a].addChild(n),d.addChild(t[a]),a+=1,U=a,t[a]=new lib.mc,t[a].scaleX=y/b,t[a].scaleY=y/b,d.addChild(t[a]),a+=1,at=a,t[a]=new lib.mc,t[a].scaleX=y/b,t[a].scaleY=y/b,d.addChild(t[a]),a+=1,rt=a,t[a]=new createjs.Container;for(let c=0;c<7;c+=1){const h=new createjs.Text(`${c+2} players`,`${Math.floor(32*y/b)}px Anton`,"#aaaaaa");h.name=`p${c}`,h.x=k/2-280*y/b+Math.floor(c%4)*(180*y/b),h.y=N*.8+Math.floor(c/4)*(60*y/b),h.textAlign="center",h.textBaseline="middle",t[a].addChild(h)}d.addChild(t[a]),a+=1,pt=a,t[a]=new createjs.Text("Now loading...",`${Math.floor(24*y/b)}px Anton`,"#000000"),d.addChild(t[a]),a+=1,M=a,t[a]=new createjs.Text("Now loading...",`${Math.floor(30*y/b)}px Roboto`,"#000000"),t[a].textAlign="center",t[a].textBaseline="middle",d.addChild(t[a]),a+=1;const p=["START","TOP PAGE","YES","NO","END TURN","TITLE","HISTORY"];ft=p.length,x=a;for(let c=0;c<ft;c+=1){const h=new lib.mc;t[a]=new createjs.Container,h.gotoAndStop("btn"),t[a].addChildAt(h,0);const _=new createjs.Text(p[c],"32px Anton","Black");_.textAlign="center",_.textBaseline="middle",t[a].addChildAt(_,1),d.addChild(t[a]),t[a].scaleX=y/b,t[a].scaleY=y/b,t[a].visible=!0,a+=1}ct=a;for(let c=0;c<ct;c+=1)t[c].visible=!1;if(d.addEventListener("stagemousedown",Yt),d.addEventListener("stagemousemove",Ot),d.addEventListener("stagemouseup",Pt),createjs.Ticker.addEventListener("tick",Ft),createjs.Ticker.setFPS(60),yt){const c=new createjs.LoadQueue(!1);c.installPlugin(createjs.Sound),c.loadManifest(Lt,!0),c.addEventListener("fileload",Dt),c.addEventListener("complete",Jt)}else g=60,j=St};window.addEventListener("load",Zt);const te=()=>{let e=-1;for(let i=0;i<7;i+=1){const a=t[rt].getChildByName(`p${i}`).globalToLocal(d.mouseX,d.mouseY);Math.abs(a.x)<70*y/b&&Math.abs(a.y)<20*y/b&&(e=i+2)}if(!(e<0)){s.pmax=e;for(let i=0;i<7;i+=1)t[rt].getChildByName(`p${i}`).color=i===s.pmax-2?"#aa0000":"#cccccc";d.update()}},ee=()=>{if(s.com_thinking()===0){Mt();return}d.update(),g=5,j=ie,z=null,R=null,L=null},ie=()=>{g-=1,!(g>0)&&(F(H,s.area_from,1),d.update(),g=5,j=ae)},ae=()=>{g-=1,!(g>0)&&(F(D,s.area_to,1),d.update(),Tt())},Tt=()=>{t[x+4].visible=!1,t[K].visible=!1;for(let i=0;i<8;i+=1)t[Z+i].visible=!1;const e=[s.area_from,s.area_to];for(let i=0;i<2;i+=1){A[i].arm=s.adat[e[i]].arm,A[i].dmax=s.adat[e[i]].dice;for(let l=0;l<8;l+=1){const a=Math.floor(Math.random()*8),o=A[i].usedice[l];A[i].usedice[l]=A[i].usedice[a],A[i].usedice[a]=o}A[i].sum=0;for(let l=0;l<8;l+=1)A[i].deme[l]=Math.floor(Math.random()*6),A[i].usedice[l]<A[i].dmax&&(A[i].sum+=1+A[i].deme[l]),A[i].fin[l]=!1}t[X].visible=!0;for(let i=0;i<2;i+=1){const r=i===0?400:-360,m=i===0?-2*50:2*60;for(let f=0;f<8;f+=1){const u=t[X].getChildByName(`d${i}${f}`);u.vx=r+f%3*10*4-Math.floor(f/3)*10*4+Math.random()*8,u.vy=m+f%3*10*2+Math.floor(f/3)*10*2+Math.random()*8,u.x=u.vx,u.y=u.vy,u.z=Math.random()*10,u.up=Math.random()*22,u.bc=0,u.visible=!1;const n=t[X].getChildByName(`s${i}${f}`);n.x=u.vx,n.y=u.vy,n.gotoAndStop("shadow"),n.visible=!1}}t[X].getChildByName("n0").x=110,t[X].getChildByName("n0").y=-10,t[X].getChildByName("n0").visible=!1,t[X].getChildByName("n1").x=-290,t[X].getChildByName("n1").y=-10,t[X].getChildByName("n1").visible=!1,w=0,d.update(),j=se,z=null,R=null,L=null},se=()=>{const e=w===0?-10:10,i=w===0?6:-6;let l=!1,a=!1;for(let o=0;o<8;o+=1){if(A[w].fin[o]>0)continue;const r=t[X].getChildByName(`d${w}${o}`);r.visible=!0,r.vx+=e,r.vy+=i,r.z+=r.up,r.up-=3,r.z<0&&(r.z=0,r.up=5-r.bc*3,r.bc+=1,r.bc>=2&&(A[w].fin[o]=1,w===0?(o>=3&&A[w].fin[o-3]===0&&(A[w].fin[o]=0),o>=2&&A[w].fin[o-2]===0&&(A[w].fin[o]=0)):(o<5&&A[w].fin[o+3]===0&&(A[w].fin[o]=0),o<6&&A[w].fin[o+2]===0&&(A[w].fin[o]=0))),r.bc===1&&A[w].usedice[o]<A[w].dmax&&(a=!0)),r.x=r.vx,r.y=r.vy-r.z,r.gotoAndStop(`d${A[w].arm}${Math.floor(Math.random()*6)}`),A[w].fin[o]>0&&(r.gotoAndStop(`d${A[w].arm}${A[w].deme[o]}`),A[w].usedice[o]<A[w].dmax&&(a=!0));const m=t[X].getChildByName(`s${w}${o}`);m.visible=!0,m.x=r.vx,m.y=r.vy,A[w].usedice[o]>=A[w].dmax&&(r.visible=!1,m.visible=!1),l=!0}l||(t[X].getChildByName(`n${w}`).visible=!0,t[X].getChildByName(`n${w}`).text=`${A[w].sum}`,w+=1,w>=2&&(g=15,j=le)),a&&P("dice"),d.update()},le=()=>{if(g-=1,g>0)return;t[X].visible=!1,t[H].visible=!1,t[D].visible=!1,t[K].visible=!0;for(let a=0;a<8;a+=1)t[Z+a].visible=!0;const e=s.adat[s.area_from].arm,i=s.adat[s.area_to].arm,l=A[0].sum>A[1].sum?1:0;if(l>0?(s.adat[s.area_to].dice=s.adat[s.area_from].dice-1,s.adat[s.area_from].dice=1,s.adat[s.area_to].arm=e,s.set_area_tc(e),s.set_area_tc(i),P("success")):(s.adat[s.area_from].dice=1,P("fail")),F(Q+s.area_to,s.area_to,0),V(tt[s.area_from],s.area_from),V(tt[s.area_to],s.area_to),s.set_his(s.area_from,s.area_to,l),s.player[s.user].area_tc===0)bt(),ne();else{let a=0;for(let o=0;o<s.pmax;o+=1)s.player[o].area_tc>0&&(a+=1);a===1?(bt(),re()):_t()}},ne=()=>{t[O].visible=!1,t[O].x=k/2,t[O].y=N/2,t[O].getChildByName("bg").alpha=0,t[O].getChildByName("mes").alpha=0,t[O].getChildByName("mes").y=-120,d.update(),T=0,g=0,j=oe,z=null,R=null,L=null},oe=()=>{if(t[O].visible=!0,g+=1,T===0){const e=(-80+g)/100;t[O].getChildByName("bg").alpha=e,e>.8&&(P("over"),g=0,T+=1),d.update()}else if(T===1){const e=g/100,i=t[O].getChildByName("mes");i.alpha=e,i.y+=.5,i.y>-70&&(i.y=-70),g>=160&&(t[x+5].x=k/2-$(100),t[x+5].y=N/2+$(70),t[x+5].visible=!0,Y[5]=xt,t[x+6].x=k/2+$(100),t[x+6].y=N/2+$(70),t[x+6].visible=!0,Y[6]=Xt,g=0,T+=1),d.update()}},re=()=>{t[U].visible=!1,t[U].x=k/2,t[U].y=N/2-$(70),t[U].gotoAndStop("win"),g=0,j=ce,z=null,R=null,L=null},ce=()=>{g+=1;const e=Math.floor(g/2);e===10||e===12||e===14||e===16||e>=18?t[U].visible=!0:t[U].visible=!1,e===10&&P("clear"),e>=40&&(j=null,t[x+6].x=k/2,t[x+6].y=N/2+$(70),t[x+6].visible=!0,Y[6]=Xt),d.update()},fe=()=>{let e;if(T===0)E>=s.his_c?j=null:T=s.his[E].to===0?1:2;else if(T===1)e=s.his[E].from,s.adat[e].dice+=1,V(tt[e],e),d.update(),E+=1,E>=s.his_c?j=null:T=s.his[E].to===0?1:2;else if(T===2)e=s.his[E].from,F(H,e,1),d.update(),g=0,T+=1;else if(T===3)g>2&&(e=s.his[E].to,F(D,e,1),d.update(),g=0,T+=1);else if(T===4&&g>10){const i=s.his[E].from,l=s.his[E].to;s.his[E].res>0?(s.adat[l].dice=s.adat[i].dice-1,s.adat[i].dice=1,s.adat[l].arm=s.adat[i].arm,P("success")):(s.adat[i].dice=1,P("fail")),t[H].visible=!1,t[D].visible=!1,V(tt[i],i),V(tt[l],l),F(Q+l,l,0),d.update(),T=0,E+=1}g+=1},Xt=()=>{t[U].visible=!1,t[O].visible=!1,t[K].visible=!1;for(let e=0;e<8;e+=1)t[Z+e].visible=!1;for(let e=0;e<ft;e+=1)t[x+e].visible=!1;for(let e=0;e<s.AREA_MAX;e+=1)s.adat[e].size!==0&&(s.adat[e].dice=s.his_dice[e],s.adat[e].arm=s.his_arm[e],F(Q+e,e,0));for(let e=0;e<s.AREA_MAX;e+=1)V(ot+e,S[e].an);t[x+5].x=k/2-$(100),t[x+5].y=N*.88,t[x+5].visible=!0,Y[5]=xt,t[x+1].x=k/2+$(100),t[x+1].y=N*.88,t[x+1].visible=!0,Y[1]=wt,d.update(),E=0,T=0,g=0,j=fe,z=null,R=null,L=null};
