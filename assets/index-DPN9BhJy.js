(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const h of n)if(h.type==="childList")for(const m of h.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function l(n){const h={};return n.integrity&&(h.integrity=n.integrity),n.referrerPolicy&&(h.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?h.credentials="include":n.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(n){if(n.ep)return;n.ep=!0;const h=l(n);fetch(n.href,h)}})();const pt=function(){this.size=0,this.cpos=0,this.arm=0,this.dice=0,this.left=0,this.right=0,this.top=0,this.bottom=0,this.cx=0,this.cy=0,this.len_min=0,this.line_cel=new Array(100),this.line_dir=new Array(100),this.join=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},Ct=function(){this.area_c=0,this.area_tc=0,this.dice_c=0,this.dice_jun=0,this.stock=0},kt=function(){this.dir=[0,0,0,0,0,0]},Et=function(){this.from=0,this.to=0,this.res=0},Rt=function(){this.next_cel=function(e,i){const l=e%this.XMAX,s=Math.floor(e/this.XMAX),n=s%2;let h=0,m=0;switch(i){case 0:h=n,m=-1;break;case 1:h=1;break;case 2:h=n,m=1;break;case 3:h=n-1,m=1;break;case 4:h=-1;break;case 5:h=n-1,m=-1;break}const r=l+h,u=s+m;return r<0||u<0||r>=this.XMAX||u>=this.YMAX?-1:u*this.XMAX+r},this.XMAX=28,this.YMAX=32,this.cel_max=this.XMAX*this.YMAX,this.cel=new Array(this.cel_max),this.join=new Array(this.cel_max);for(let e=0;e<this.cel_max;e+=1){this.join[e]=new kt;for(let i=0;i<6;i+=1)this.join[e].dir[i]=this.next_cel(e,i)}this.AREA_MAX=32,this.adat=new Array;for(let e=0;e<32;e+=1)this.adat[e]=new pt;this.num=new Array(this.cel_max);for(let e=0;e<this.cel_max;e+=1)this.num[e]=e;this.rcel=new Array(this.cel_max),this.next_f=new Array(this.cel_max),this.alist=new Array(this.AREA_MAX),this.chk=new Array(this.AREA_MAX),this.tc=new Array(this.AREA_MAX),this.pmax=7,this.user=0,this.put_dice=3,this.jun=[0,1,2,3,4,5,6,7],this.ban=0,this.area_from=0,this.area_to=0,this.defeat=0,this.player=new Array(8),this.STOCK_MAX=64,this.list_from=new Array(this.AREA_MAX*this.AREA_MAX),this.list_to=new Array(this.AREA_MAX*this.AREA_MAX),this.his=new Array,this.his_c=0,this.his_arm=new Array(this.AREA_MAX),this.his_dice=new Array(this.AREA_MAX),this.start_game=function(){for(let e=0;e<8;e+=1)this.jun[e]=e;for(let e=0;e<this.pmax;e+=1){const i=Math.floor(Math.random()*this.pmax),l=this.jun[e];this.jun[e]=this.jun[i],this.jun[i]=l}this.ban=0;for(let e=0;e<8;e+=1)this.player[e]=new Ct;for(let e=0;e<8;e+=1)this.set_area_tc(e);this.his_c=0;for(let e=0;e<this.AREA_MAX;e+=1)this.his_arm[e]=this.adat[e].arm,this.his_dice[e]=this.adat[e].dice},this.set_area_tc=function(e){this.player[e].area_tc=0;for(let l=0;l<this.AREA_MAX;l+=1)this.chk[l]=l;for(;;){let l=0;for(let s=1;s<this.AREA_MAX;s+=1)if(this.adat[s].size!=0&&this.adat[s].arm==e){for(let n=1;n<this.AREA_MAX;n+=1)if(this.adat[n].size!=0&&this.adat[n].arm==e&&this.adat[s].join[n]!=0&&this.chk[n]!=this.chk[s]){this.chk[s]>this.chk[n]?this.chk[s]=this.chk[n]:this.chk[n]=this.chk[s],l=1;break}if(l)break}if(l==0)break}for(let l=0;l<this.AREA_MAX;l+=1)this.tc[l]=0;for(let l=1;l<this.AREA_MAX;l+=1)this.adat[l].size!=0&&this.adat[l].arm==e&&(this.tc[this.chk[l]]+=1);let i=0;for(let l=0;l<this.AREA_MAX;l+=1)this.tc[l]>i&&(i=this.tc[l]);this.player[e].area_tc=i},this.get_pn=function(){return this.jun[this.ban]},this.make_map=function(){let e;for(let o=0;o<this.cel_max;o+=1){const A=Math.floor(Math.random()*this.cel_max),c=this.num[o];this.num[o]=this.num[A],this.num[A]=c}for(let o=0;o<this.cel_max;o+=1)this.cel[o]=0,this.rcel[o]=0;let i=1;for(this.rcel[Math.floor(Math.random()*this.cel_max)]=1;;){let o,A=9999;for(let d=0;d<this.cel_max;d+=1)this.cel[d]>0||this.num[d]>A||this.rcel[d]!=0&&(A=this.num[d],o=d);if(A==9999||this.percolate(o,8,i)==0||(i+=1,i>=this.AREA_MAX))break}for(let o=0;o<this.cel_max;o+=1){if(this.cel[o]>0)continue;let A=0,c=0;for(let d=0;d<6;d+=1){const y=this.join[o].dir[d];y<0||(this.cel[y]==0?A=1:c=this.cel[y])}A==0&&(this.cel[o]=c)}for(let o=0;o<this.AREA_MAX;o+=1)this.adat[o]=new pt;for(let o=0;o<this.cel_max;o+=1)i=this.cel[o],i>0&&(this.adat[i].size+=1);for(let o=1;o<this.AREA_MAX;o+=1)this.adat[o].size<=5&&(this.adat[o].size=0);for(let o=0;o<this.cel_max;o+=1)i=this.cel[o],this.adat[i].size==0&&(this.cel[o]=0);for(let o=1;o<this.AREA_MAX;o+=1)this.adat[o].left=this.XMAX,this.adat[o].right=-1,this.adat[o].top=this.YMAX,this.adat[o].bottom=-1,this.adat[o].len_min=9999;e=0;for(let o=0;o<this.YMAX;o+=1)for(let A=0;A<this.XMAX;A+=1)i=this.cel[e],i>0&&(A<this.adat[i].left&&(this.adat[i].left=A),A>this.adat[i].right&&(this.adat[i].right=A),o<this.adat[i].top&&(this.adat[i].top=o),o>this.adat[i].bottom&&(this.adat[i].bottom=o)),e+=1;for(let o=1;o<this.AREA_MAX;o+=1)this.adat[o].cx=Math.floor((this.adat[o].left+this.adat[o].right)/2),this.adat[o].cy=Math.floor((this.adat[o].top+this.adat[o].bottom)/2);e=0;let l,s,n;for(let o=0;o<this.YMAX;o+=1)for(let A=0;A<this.XMAX;A+=1){if(i=this.cel[e],i>0){l=this.adat[i].cx-A,l<0&&(l=-l),s=this.adat[i].cy-o,s<0&&(s=-s),n=l+s;let c=0;for(let d=0;d<6;d+=1){const y=this.join[e].dir[d];if(y>0){const X=this.cel[y];X!=i&&(c=1,this.adat[i].join[X]=1)}}c&&(n+=4),n<this.adat[i].len_min&&(this.adat[i].len_min=n,this.adat[i].cpos=o*this.XMAX+A)}e+=1}for(let o=0;o<this.AREA_MAX;o+=1)this.adat[o].arm=-1;let h=0;const m=new Array(this.AREA_MAX);for(;;){let o=0;for(let c=1;c<this.AREA_MAX;c+=1)this.adat[c].size!=0&&(this.adat[c].arm>=0||(m[o]=c,o+=1));if(o==0)break;const A=m[Math.floor(Math.random()%o)];this.adat[A].arm=h,h+=1,h>=this.pmax&&(h=0)}for(let o=0;o<this.AREA_MAX;o+=1)this.chk[o]=0;for(let o=0;o<this.cel_max;o+=1){const A=this.cel[o];if(A!=0&&!(this.chk[A]>0))for(let c=0;c<6&&!(this.chk[A]>0);c+=1){const d=this.join[o].dir[c];d>=0&&this.cel[d]!=A&&(this.set_area_line(o,c),this.chk[A]=1)}}let r=0;for(let o=1;o<this.AREA_MAX;o+=1)this.adat[o].size>0&&(r+=1,this.adat[o].dice=1);r*=this.put_dice-1;let u=0;for(let o=0;o<r;o+=1){const A=new Array(this.AREA_MAX);let c=0;for(let y=1;y<this.AREA_MAX;y+=1)this.adat[y].size!=0&&this.adat[y].arm==u&&(this.adat[y].dice>=8||(A[c]=y,c+=1));if(c==0)break;const d=A[Math.floor(Math.random()*c)];this.adat[d].dice+=1,u+=1,u>=this.pmax&&(u=0)}},this.percolate=function(e,i,l){i<3&&(i=3);let s,n=e;for(let m=0;m<this.cel_max;m+=1)this.next_f[m]=0;let h=0;for(;;){for(this.cel[n]=l,h+=1,s=0;s<6;s+=1){const r=this.join[n].dir[s];r<0||(this.next_f[r]=1)}let m=9999;for(let r=0;r<this.cel_max;r+=1)this.next_f[r]!=0&&(this.cel[r]>0||this.num[r]>m||(m=this.num[r],n=r));if(m==9999||h>=i)break}for(let m=0;m<this.cel_max;m+=1)if(this.next_f[m]!=0&&!(this.cel[m]>0)){this.cel[m]=l,h+=1;for(let r=0;r<6;r+=1){const u=this.join[m].dir[r];u<0||(this.rcel[u]=1)}}return h},this.set_area_line=function(e,i){let l=e,s=i;const n=this.cel[l];let h=0;this.adat[n].line_cel[h]=l,this.adat[n].line_dir[h]=s,h+=1;for(let m=0;m<100;m+=1){s+=1,s>=6&&(s=0);const r=this.join[l].dir[s];if(r>=0&&this.cel[r]==n&&(l=r,s-=2,s<0&&(s+=6)),this.adat[n].line_cel[h]=l,this.adat[n].line_dir[h]=s,h+=1,l==e&&s==i)break}},this.com_thinking=function(){for(let r=0;r<8;r+=1)this.player[r].area_c=0,this.player[r].dice_c=0;let e=0;for(let r=1;r<this.AREA_MAX;r+=1){if(this.adat[r].size==0)continue;const u=this.adat[r].arm;this.player[u].area_c+=1,this.player[u].dice_c+=this.adat[r].dice,e+=this.adat[r].dice}for(let r=0;r<8;r+=1)this.player[r].dice_jun=r;for(let r=0;r<7;r+=1)for(let u=r+1;u<8;u+=1)if(this.player[r].dice_c<this.player[u].dice_c){const o=this.player[r].dice_jun;this.player[r].dice_jun=this.player[u].dice_jun,this.player[u].dice_jun=o}let i=-1;for(let r=0;r<8;r+=1)this.player[r].dice_c>e*2/5&&(i=r);const l=new Array(this.AREA_MAX*this.AREA_MAX),s=new Array(this.AREA_MAX*this.AREA_MAX),n=this.jun[this.ban];let h=0;for(let r=1;r<this.AREA_MAX;r+=1)if(this.adat[r].size!=0&&this.adat[r].arm==n&&!(this.adat[r].dice<=1)){for(let u=1;u<this.AREA_MAX;u+=1)if(this.adat[u].size!=0&&this.adat[u].arm!=n&&this.adat[r].join[u]!=0&&!(i>=0&&this.adat[r].arm!=i&&this.adat[u].arm!=i)&&!(this.adat[u].dice>this.adat[r].dice)){if(this.adat[u].dice==this.adat[r].dice){const o=this.adat[u].arm;let A=0;if(this.player[n].dice_jun==0&&(A=1),this.player[o].dice_jun==0&&(A=1),Math.random()*10>1&&(A=1),A==0)continue}l[h]=r,s[h]=u,h+=1}}if(h==0)return 0;const m=Math.floor(Math.random()*h);this.area_from=l[m],this.area_to=s[m]},this.set_his=function(e,i,l){this.his[this.his_c]=new Et,this.his[this.his_c].from=e,this.his[this.his_c].to=i,this.his[this.his_c].res=l,this.his_c+=1}};let et,f,rt,_t=!1,g,$,N,z,v=0,k=0;const a=new Rt,ct=[],R={viewW:840,viewH:840,celW:27,celH:18,yposMes:688,yposArm:770};let p=1,_=1,j,T,W,tt,I,ht;const it=[],ot=[],t=[];let K=0,F=0,H=0,st=0,yt=0,D=0,Q=0,E=0,q=0,L=0,G=0,Z=0,at=0,dt=0,w=0,b=0,lt=0;const C=[],V=[];let nt=0,J=-1;const Y=[],St=function(){this.dn=0,this.arm=0,this.dmax=0,this.deme=[0,0,0,0,0,0,0,0],this.sum=0,this.fin=[0,0,0,0,0,0,0,0],this.usedice=[0,1,2,3,4,5,6,7]},x=[];let M=0,B=0,ft=!0;const Bt=[{src:"/dice-reverse/sound/button.wav",id:"snd_button"},{src:"/dice-reverse/sound/clear.wav",id:"snd_clear"},{src:"/dice-reverse/sound/click.wav",id:"snd_click"},{src:"/dice-reverse/sound/dice.wav",id:"snd_dice"},{src:"/dice-reverse/sound/fail.wav",id:"snd_fail"},{src:"/dice-reverse/sound/myturn.wav",id:"snd_myturn"},{src:"/dice-reverse/sound/over.wav",id:"snd_over"},{src:"/dice-reverse/sound/success.wav",id:"snd_success"}],bt=()=>{location.href="https://www.gamedesign.jp/"},S=e=>e*p/_,O=e=>{ft&&(ct[e].setVolume(.5),ct[e].play())},Tt=e=>{$!=null&&$(e),et.style.cursor="default"},$t=e=>{N!=null&&N(e),et.style.cursor="default"},Nt=e=>{z!=null&&z(e),et.style.cursor="default",J>=0&&Y[J]!=null&&(O("snd_button"),Y[J]())},zt=()=>{let e,i=-1;for(let l=0;l<nt;l+=1)if(e=b+l,t[e].visible){const s=t[e].globalToLocal(f.mouseX,f.mouseY);t[e].hitTest(s.x,s.y)&&(i=l)}if(J!==i){J=i;for(let l=0;l<nt;l+=1)l===J?t[b+l].getChildAt(0).gotoAndStop("press"):t[b+l].getChildAt(0).gotoAndStop("btn");f.update()}},Yt=()=>{g!=null&&g(),zt()},Lt=e=>{ct[e]=createjs.Sound.createInstance(e)},Ot=e=>{const i={...e.item};i.type===createjs.LoadQueue.SOUND&&Lt(i.id)},P=(e,i,l)=>{if(a.adat[i].size===0){t[e].visible=!1;return}t[e].visible=!0,t[e].graphics.clear();let s=0,n=a.adat[i].line_cel[s],h=a.adat[i].line_dir[s];const m=[W/2,W,W,W/2,0,0,W/2],r=3*p/_,u=[-r,r,tt-r,tt+r,tt-r,r,-r];let o="#222244";l&&(o="#ff0000"),t[e].graphics.beginStroke(o);let c=["#b37ffe","#b3ff01","#009302","#ff7ffe","#ff7f01","#b3fffe","#ffff01","#ff5858"][a.adat[i].arm];l&&(c="#000000"),t[e].graphics.setStrokeStyle(4*p/_,"round","round").beginFill(c);let d=m[h],y=u[h];t[e].graphics.moveTo(it[n]+d,ot[n]+y);for(let X=0;X<100&&(d=m[h+1],y=u[h+1],t[e].graphics.lineTo(it[n]+d,ot[n]+y),s+=1,n=a.adat[i].line_cel[s],h=a.adat[i].line_dir[s],!(n===a.adat[i].line_cel[0]&&h===a.adat[i].line_dir[0]));X+=1);},U=(e,i)=>{if(a.adat[i].size===0){t[e].visible=!1;return}t[e].visible=!0;const l=a.adat[i].cpos;t[e].x=Math.floor(it[l]+6*p/_),t[e].y=Math.floor(ot[l]-10*p/_),t[e].gotoAndStop(a.adat[i].arm*10+a.adat[i].dice-1)},ut=()=>{let e=0;for(let l=0;l<8;l+=1){t[Q+l].visible=!1;const s=a.jun[l];a.player[s].area_tc>0&&(t[Q+l].visible=!0,e+=1)}let i=0;for(let l=0;l<8;l+=1){const s=a.jun[l];if(a.player[s].area_tc!==0){const n=Q+l,h=100*p/_,m=j/2-(e-1)*h/2+i*h;t[n].x=m,t[n].y=ht,t[n].getChildAt(0).gotoAndStop(`d${s}0`),t[n].getChildAt(1).text=`${a.player[s].area_tc}`,t[n].getChildAt(2).text="",a.player[s].stock>0&&(t[n].getChildAt(2).text=`${a.player[s].stock}`),l===a.ban&&(t[D].x=m,t[D].y=ht,t[D].gotoAndStop("ban"),t[D].visible=!0),i+=1}}},Wt=()=>{for(let e=0;e<a.pmax;e+=1){a.ban+=1,a.ban>=a.pmax&&(a.ban=0);const i=a.jun[a.ban];if(a.player[i].area_tc)break}a.jun[a.ban]===a.user&&O("snd_myturn"),mt()},Pt=()=>{const e=a.jun[a.ban],i=[];let l=0;for(let n=0;n<a.AREA_MAX;n+=1)a.adat[n].size!==0&&a.adat[n].arm===e&&(a.adat[n].dice>=8||(i[l]=n,l+=1));if(l===0||a.player[e].stock<=0){Wt();return}a.player[e].stock-=1;const s=i[Math.floor(Math.random()*l)];a.adat[s].dice+=1,U(V[s],s);for(let n=0;n<a.STOCK_MAX;n+=1)n<a.player[e].stock?t[q].getChildAt(n).visible=!0:t[q].getChildAt(n).visible=!1;a.set_his(s,0,0),f.update()},Ft=()=>{v-=1,!(v>0)&&(g=Pt)},xt=()=>{t[F].visible=!1,t[H].visible=!1,t[b+4].visible=!1;const e=a.jun[a.ban];a.set_area_tc(e),a.player[e].stock+=a.player[e].area_tc,a.player[e].stock>a.STOCK_MAX&&(a.player[e].stock=a.STOCK_MAX),t[q].visible=!0;for(let i=0;i<a.STOCK_MAX;i+=1)i<a.player[e].stock?(t[q].getChildAt(i).visible=!0,t[q].getChildAt(i).gotoAndStop(`d${e}3`)):t[q].getChildAt(i).visible=!1;f.update(),v=10,g=Ft,$=null,N=null,z=null},Ht=()=>{t[b+4].visible=!1,t[F].visible=!1,t[H].visible=!1,t[w].visible=!1,g=null,$=null,N=null,z=null,xt()},vt=()=>{let e=-1,i;for(let l=0;l<a.AREA_MAX;l+=1)if(a.adat[l].size!==0){i=K+l;const s=t[i].globalToLocal(f.mouseX,f.mouseY);t[i].hitTest(s.x,s.y)&&(e=l)}for(let l=0;l<a.AREA_MAX;l+=1){const s=C[l].an;if(a.adat[s].size!==0){i=st+l;const n=t[i].globalToLocal(f.mouseX,f.mouseY);t[i].hitTest(n.x,n.y)&&(e=s)}}return e},Dt=()=>{const e=a.jun[a.ban],i=vt();if(!(i<0)){if(i===a.area_from){Mt();return}a.adat[i].arm!==e&&a.adat[i].join[a.area_from]!==0&&(a.area_to=i,P(H,i,1),f.update(),O("snd_click"),Xt())}},Gt=()=>{const e=a.jun[a.ban],i=vt();i<0||a.adat[i].arm===e&&(a.adat[i].dice<=1||(t[w].visible=!1,a.area_from=i,P(F,i,1),O("snd_click"),f.update(),$=Dt))},Mt=()=>{t[w].visible=!0,t[w].text="1. Click your area. 2. Click neighbor to attack.",t[w].color="#000000",t[w].textAlign="left",t[w].x=j*.05,t[w].y=I,J=-1,t[b+4].x=j-100*p/_,t[b+4].y=I,t[b+4].visible=!0,Y[4]=Ht,t[F].visible=!1,t[H].visible=!1,f.update(),g=null,$=Gt,N=null,z=null},mt=()=>{for(let e=yt;e<lt;e+=1)t[e].visible=!1;ut(),a.jun[a.ban]===a.user?Mt():Qt()},It=()=>{a.start_game(),mt()},wt=()=>{let e;for(let i=0;i<lt;i+=1)t[i].visible=!1;a.make_map();for(let i=0;i<a.AREA_MAX;i+=1)e=C[i].an,C[i].cpos=a.adat[e].cpos;for(let i=0;i<a.AREA_MAX-1;i+=1)for(let l=i;l<a.AREA_MAX;l+=1)if(C[i].cpos>C[l].cpos){let s=C[i].an;C[i].an=C[l].an,C[l].an=s,s=C[i].cpos,C[i].cpos=C[l].cpos,C[l].cpos=s}for(let i=0;i<a.AREA_MAX;i+=1)e=C[i].an,V[e]=st+i;for(let i=0;i<a.AREA_MAX;i+=1)P(K+i,i,0);for(let i=0;i<a.AREA_MAX;i+=1)U(st+i,C[i].an);t[w].visible=!0,t[w].text="Play this board?",t[w].color="#000000",t[w].textAlign="left",t[w].x=j*.1,t[w].y=I,t[b+2].x=S(500),t[b+2].y=I,t[b+2].visible=!0,Y[2]=It,t[b+3].x=S(650),t[b+3].y=I,t[b+3].visible=!0,Y[3]=wt,f.update(),g=null,$=null,N=null,z=null},At=()=>{for(let e=0;e<lt;e+=1)t[e].visible=!1;t[Z].visible=!0,t[Z].x=0,t[Z].y=0,t[Z].gotoAndStop("title"),t[w].visible=!0,t[w].text="Copyright (C) 2001 GAMEDESIGN",t[w].color="#aaaaaa",t[w].textAlign="right",t[w].x=j*.9,t[w].y=T*.24,t[at].visible=!0;for(let e=0;e<7;e+=1)t[at].getChildByName(`p${e}`).color=e===a.pmax-2?"#aa0000":"#cccccc";t[b+0].x=S(640),t[b+0].y=S(390),t[b+0].visible=!0,Y[0]=wt,t[b+1].x=S(640),t[b+1].y=S(490),t[b+1].visible=!0,Y[1]=bt,f.update(),g=null,$=qt,N=null,z=null},gt=()=>{t[dt].visible=!0,t[dt].text=" ",t[w].visible=!0,t[w].text="Now loading... ",t[w].x=j/2,t[w].y=T/2,f.update(),v-=1,v<=0&&(g=null,At())},Kt=()=>{v=30,g=gt},Ut=()=>{let e;et=document.getElementById("myCanvas"),f=new createjs.Stage(et),createjs.Touch.isSupported()===!0&&(createjs.Touch.enable(f),_t=!0),_t&&(ft=!1);const i=window.innerWidth,l=window.innerHeight;i/R.viewW<l/R.viewH?(p=i,_=R.viewW):(p=l,_=R.viewH),j=Math.floor(R.viewW*p/_),T=Math.floor(R.viewH*p/_),f.canvas.width=j,f.canvas.height=T,W=R.celW*p/_,tt=R.celH*p/_,I=R.yposMes*p/_,ht=R.yposArm*p/_;for(let c=0;c<2;c+=1)x[c]=new St;let s=0;e=0;for(let c=0;c<a.YMAX;c+=1)for(let d=0;d<a.XMAX;d+=1)it[e]=d*W,c%2&&(it[e]+=W/2),ot[e]=c*tt,e+=1;K=s;for(let c=0;c<a.AREA_MAX+2;c+=1)t[s]=new createjs.Shape,t[s].x=j/2-a.XMAX*W/2-W/4,t[s].y=50*p/_,f.addChild(t[s]),s+=1;F=K+a.AREA_MAX,H=K+a.AREA_MAX+1,st=s,rt=new createjs.SpriteSheetBuilder;const n=new lib.areadice,h=new createjs.Rectangle(0,0,80,100);rt.addMovieClip(n,h,p/_);const m=rt.build();for(let c=0;c<a.AREA_MAX;c+=1)t[s]=new createjs.Sprite(m),f.addChild(t[s]),s+=1;for(let c=0;c<a.AREA_MAX;c+=1)C[c]={},C[c].an=c,C[c].cpos=0;yt=s,D=s,t[s]=new lib.mc,f.addChild(t[s]),t[s].scaleX=p/_,t[s].scaleY=p/_,s+=1,Q=s;for(let c=0;c<8;c+=1){const d=new lib.mc;d.scaleX=.12,d.scaleY=.12,d.x=-22,d.y=0,t[s]=new createjs.Container,t[s].addChildAt(d,0);const y=new createjs.Text("","32px Anton","Black");y.textBaseline="middle",y.x=5,t[s].addChildAt(y,1);const X=new createjs.Text("","16px Anton","Black");X.textBaseline="middle",X.x=5,X.y=28,t[s].addChildAt(X,2),f.addChild(t[s]),t[s].scaleX=p/_,t[s].scaleY=p/_,s+=1}E=s,t[s]=new createjs.Container,t[s].y=I,t[s].x=j/2,t[s].scaleX=p/_,t[s].scaleY=p/_;const r=new createjs.Shape;r.graphics.beginFill("rgba(255,255,255,0.8)").drawRect(-R.viewW/2,-50,R.viewW,360),t[s].addChild(r);for(let c=0;c<2;c+=1){for(let y=0;y<8;y+=1){const X=new lib.mc;X.scaleX=.15,X.scaleY=.15,X.name=`s${c}${y}`,t[s].addChild(X)}for(let y=0;y<8;y+=1){const X=new lib.mc;X.scaleX=.15,X.scaleY=.15,X.name=`d${c}${y}`,t[s].addChild(X)}const d=new createjs.Text("37","80px Anton","Black");d.textBaseline="middle",d.textAlign="center",d.name=`n${c}`,t[s].addChild(d)}f.addChild(t[s]),s+=1,q=s,t[s]=new createjs.Container,t[s].y=I,t[s].x=j/2,t[s].scaleX=p/_,t[s].scaleY=p/_;for(let c=0;c<a.STOCK_MAX;c+=1){const d=new lib.mc,y=40;d.x=-(6.5*y)+Math.floor(c/4)*y-c%4*y*.5,d.y=-y*.7+Math.floor(c%4)*y/2,d.gotoAndStop("d00"),d.scaleX=.1,d.scaleY=.1,t[s].addChildAt(d,c)}f.addChild(t[s]),s+=1,L=s,t[s]=new createjs.Container,t[s].x=j/2,t[s].y=T/2,t[s].scaleX=p/_,t[s].scaleY=p/_;const u=new createjs.Shape;u.graphics.beginFill("#000000").drawRect(-R.viewW/2+10,-180,R.viewW-20,360),u.name="bg",t[s].addChild(u);const o=new createjs.Text("G A M E O V E R","80px Anton","White");o.textBaseline="middle",o.textAlign="center",o.name="mes",t[s].addChild(o),f.addChild(t[s]),s+=1,G=s,t[s]=new lib.mc,t[s].scaleX=p/_,t[s].scaleY=p/_,f.addChild(t[s]),s+=1,Z=s,t[s]=new lib.mc,t[s].scaleX=p/_,t[s].scaleY=p/_,f.addChild(t[s]),s+=1,at=s,t[s]=new createjs.Container;for(let c=0;c<7;c+=1){const d=new createjs.Text(`${c+2} players`,`${Math.floor(32*p/_)}px Anton`,"#aaaaaa");d.name=`p${c}`,d.x=j/2-280*p/_+Math.floor(c%4)*(180*p/_),d.y=T*.8+Math.floor(c/4)*(60*p/_),d.textAlign="center",d.textBaseline="middle",t[s].addChild(d)}f.addChild(t[s]),s+=1,dt=s,t[s]=new createjs.Text("Now loading...",`${Math.floor(24*p/_)}px Anton`,"#000000"),f.addChild(t[s]),s+=1,w=s,t[s]=new createjs.Text("Now loading...",`${Math.floor(30*p/_)}px Roboto`,"#000000"),t[s].textAlign="center",t[s].textBaseline="middle",f.addChild(t[s]),s+=1;const A=["START","TOP PAGE","YES","NO","END TURN","TITLE","HISTORY"];nt=A.length,b=s;for(let c=0;c<nt;c+=1){const d=new lib.mc;t[s]=new createjs.Container,d.gotoAndStop("btn"),t[s].addChildAt(d,0);const y=new createjs.Text(A[c],"32px Anton","Black");y.textAlign="center",y.textBaseline="middle",t[s].addChildAt(y,1),f.addChild(t[s]),t[s].scaleX=p/_,t[s].scaleY=p/_,t[s].visible=!0,s+=1}lt=s;for(let c=0;c<lt;c+=1)t[c].visible=!1;if(f.addEventListener("stagemousedown",Tt),f.addEventListener("stagemousemove",$t),f.addEventListener("stagemouseup",Nt),createjs.Ticker.addEventListener("tick",Yt),createjs.Ticker.setFPS(60),ft){const c=new createjs.LoadQueue(!1);c.installPlugin(createjs.Sound),c.loadManifest(Bt,!0),c.addEventListener("fileload",Ot),c.addEventListener("complete",Kt)}else v=60,g=gt};window.addEventListener("load",Ut);const qt=()=>{let e=-1;for(let i=0;i<7;i+=1){const s=t[at].getChildByName(`p${i}`).globalToLocal(f.mouseX,f.mouseY);Math.abs(s.x)<70*p/_&&Math.abs(s.y)<20*p/_&&(e=i+2)}if(!(e<0)){a.pmax=e;for(let i=0;i<7;i+=1)t[at].getChildByName(`p${i}`).color=i===a.pmax-2?"#aa0000":"#cccccc";f.update()}},Qt=()=>{if(a.com_thinking()===0){xt();return}f.update(),v=5,g=Vt,$=null,N=null,z=null},Vt=()=>{v-=1,!(v>0)&&(P(F,a.area_from,1),f.update(),v=5,g=Jt)},Jt=()=>{v-=1,!(v>0)&&(P(H,a.area_to,1),f.update(),Xt())},Xt=()=>{t[b+4].visible=!1,t[D].visible=!1;for(let i=0;i<8;i+=1)t[Q+i].visible=!1;const e=[a.area_from,a.area_to];for(let i=0;i<2;i+=1){x[i].arm=a.adat[e[i]].arm,x[i].dmax=a.adat[e[i]].dice;for(let l=0;l<8;l+=1){const s=Math.floor(Math.random()*8),n=x[i].usedice[l];x[i].usedice[l]=x[i].usedice[s],x[i].usedice[s]=n}x[i].sum=0;for(let l=0;l<8;l+=1)x[i].deme[l]=Math.floor(Math.random()*6),x[i].usedice[l]<x[i].dmax&&(x[i].sum+=1+x[i].deme[l]),x[i].fin[l]=!1}t[E].visible=!0;for(let i=0;i<2;i+=1){const h=i===0?400:-360,m=i===0?-2*50:2*60;for(let r=0;r<8;r+=1){const u=t[E].getChildByName(`d${i}${r}`);u.vx=h+r%3*10*4-Math.floor(r/3)*10*4+Math.random()*8,u.vy=m+r%3*10*2+Math.floor(r/3)*10*2+Math.random()*8,u.x=u.vx,u.y=u.vy,u.z=Math.random()*10,u.up=Math.random()*22,u.bc=0,u.visible=!1;const o=t[E].getChildByName(`s${i}${r}`);o.x=u.vx,o.y=u.vy,o.gotoAndStop("shadow"),o.visible=!1}}t[E].getChildByName("n0").x=110,t[E].getChildByName("n0").y=-10,t[E].getChildByName("n0").visible=!1,t[E].getChildByName("n1").x=-290,t[E].getChildByName("n1").y=-10,t[E].getChildByName("n1").visible=!1,M=0,f.update(),g=Zt,$=null,N=null,z=null},Zt=()=>{const e=M===0?-10:10,i=M===0?6:-6;let l=!1,s=!1;for(let n=0;n<8;n+=1){if(x[M].fin[n]>0)continue;const h=t[E].getChildByName(`d${M}${n}`);h.visible=!0,h.vx+=e,h.vy+=i,h.z+=h.up,h.up-=3,h.z<0&&(h.z=0,h.up=5-h.bc*3,h.bc+=1,h.bc>=2&&(x[M].fin[n]=1,M===0?(n>=3&&x[M].fin[n-3]===0&&(x[M].fin[n]=0),n>=2&&x[M].fin[n-2]===0&&(x[M].fin[n]=0)):(n<5&&x[M].fin[n+3]===0&&(x[M].fin[n]=0),n<6&&x[M].fin[n+2]===0&&(x[M].fin[n]=0))),h.bc===1&&x[M].usedice[n]<x[M].dmax&&(s=!0)),h.x=h.vx,h.y=h.vy-h.z,h.gotoAndStop(`d${x[M].arm}${Math.floor(Math.random()*6)}`),x[M].fin[n]>0&&(h.gotoAndStop(`d${x[M].arm}${x[M].deme[n]}`),x[M].usedice[n]<x[M].dmax&&(s=!0));const m=t[E].getChildByName(`s${M}${n}`);m.visible=!0,m.x=h.vx,m.y=h.vy,x[M].usedice[n]>=x[M].dmax&&(h.visible=!1,m.visible=!1),l=!0}l||(t[E].getChildByName(`n${M}`).visible=!0,t[E].getChildByName(`n${M}`).text=`${x[M].sum}`,M+=1,M>=2&&(v=15,g=te)),s&&O("snd_dice"),f.update()},te=()=>{if(v-=1,v>0)return;t[E].visible=!1,t[F].visible=!1,t[H].visible=!1,t[D].visible=!0;for(let s=0;s<8;s+=1)t[Q+s].visible=!0;const e=a.adat[a.area_from].arm,i=a.adat[a.area_to].arm,l=x[0].sum>x[1].sum?1:0;if(l>0?(a.adat[a.area_to].dice=a.adat[a.area_from].dice-1,a.adat[a.area_from].dice=1,a.adat[a.area_to].arm=e,a.set_area_tc(e),a.set_area_tc(i),O("snd_success")):(a.adat[a.area_from].dice=1,O("snd_fail")),P(K+a.area_to,a.area_to,0),U(V[a.area_from],a.area_from),U(V[a.area_to],a.area_to),a.set_his(a.area_from,a.area_to,l),a.player[a.user].area_tc===0)ut(),ee();else{let s=0;for(let n=0;n<a.pmax;n+=1)a.player[n].area_tc>0&&(s+=1);s===1?(ut(),se()):mt()}},ee=()=>{t[L].visible=!1,t[L].x=j/2,t[L].y=T/2,t[L].getChildByName("bg").alpha=0,t[L].getChildByName("mes").alpha=0,t[L].getChildByName("mes").y=-120,f.update(),k=0,v=0,g=ie,$=null,N=null,z=null},ie=()=>{if(t[L].visible=!0,v+=1,k===0){const e=(-80+v)/100;t[L].getChildByName("bg").alpha=e,e>.8&&(O("snd_over"),v=0,k+=1),f.update()}else if(k===1){const e=v/100,i=t[L].getChildByName("mes");i.alpha=e,i.y+=.5,i.y>-70&&(i.y=-70),v>=160&&(t[b+5].x=j/2-S(100),t[b+5].y=T/2+S(70),t[b+5].visible=!0,Y[5]=At,t[b+6].x=j/2+S(100),t[b+6].y=T/2+S(70),t[b+6].visible=!0,Y[6]=jt,v=0,k+=1),f.update()}},se=()=>{t[G].visible=!1,t[G].x=j/2,t[G].y=T/2-S(70),t[G].gotoAndStop("win"),v=0,g=ae,$=null,N=null,z=null},ae=()=>{v+=1;const e=Math.floor(v/2);e===10||e===12||e===14||e===16||e>=18?t[G].visible=!0:t[G].visible=!1,e===10&&O("snd_clear"),e>=40&&(g=null,t[b+6].x=j/2,t[b+6].y=T/2+S(70),t[b+6].visible=!0,Y[6]=jt),f.update()},le=()=>{let e;if(k===0)B>=a.his_c?g=null:k=a.his[B].to===0?1:2;else if(k===1)e=a.his[B].from,a.adat[e].dice+=1,U(V[e],e),f.update(),B+=1,B>=a.his_c?g=null:k=a.his[B].to===0?1:2;else if(k===2)e=a.his[B].from,P(F,e,1),f.update(),v=0,k+=1;else if(k===3)v>2&&(e=a.his[B].to,P(H,e,1),f.update(),v=0,k+=1);else if(k===4&&v>10){const i=a.his[B].from,l=a.his[B].to;a.his[B].res>0?(a.adat[l].dice=a.adat[i].dice-1,a.adat[i].dice=1,a.adat[l].arm=a.adat[i].arm,O("snd_success")):(a.adat[i].dice=1,O("snd_fail")),t[F].visible=!1,t[H].visible=!1,U(V[i],i),U(V[l],l),P(K+l,l,0),f.update(),k=0,B+=1}v+=1},jt=()=>{t[G].visible=!1,t[L].visible=!1,t[D].visible=!1;for(let e=0;e<8;e+=1)t[Q+e].visible=!1;for(let e=0;e<nt;e+=1)t[b+e].visible=!1;for(let e=0;e<a.AREA_MAX;e+=1)a.adat[e].size!==0&&(a.adat[e].dice=a.his_dice[e],a.adat[e].arm=a.his_arm[e],P(K+e,e,0));for(let e=0;e<a.AREA_MAX;e+=1)U(st+e,C[e].an);t[b+5].x=j/2-S(100),t[b+5].y=T*.88,t[b+5].visible=!0,Y[5]=At,t[b+1].x=j/2+S(100),t[b+1].y=T*.88,t[b+1].visible=!0,Y[1]=bt,f.update(),B=0,k=0,v=0,g=le,$=null,N=null,z=null};
